# frozen_string_literal: true
RSpec.shared_context "Tika output" do
  let(:tika_tiff_output) { '{"Bits Per Sample":"8 8 8 bits/component/pixel","Compression":"Uncompressed","Content-Length":"196882","Content-Type":"image/tiff","Creation-Date":"2014-12-03T12:40:50","Date/Time":"2014:12:03 12:40:50","Document Name":"color_200.tif","File Modified Date":"Thu Jul 13 17:34:57 PDT 2017","File Name":"example.tif20170713-88893-1cirjkm","File Size":"196882 bytes","Fill Order":"Normal","Image Height":"287 pixels","Image Width":"200 pixels","Inter Color Profile":"[560 bytes]","Last-Modified":"2014-12-03T12:40:50","Last-Save-Date":"2014-12-03T12:40:50","Make":"Phase One","Model":"P65+","Orientation":"Top, left side (Horizontal / normal)","Photometric Interpretation":"RGB","Planar Configuration":"Chunky (contiguous for each subsampling pixel)","Primary Chromaticities":"2748779008/4294967295 1417339264/4294967295 1288490240/4294967295 2576980480/4294967295 644245120/4294967295 257698032/4294967295","Resolution Unit":"Inch","Rows Per Strip":"13 rows/strip","Samples Per Pixel":"3 samples/pixel","Software":"Adobe Photoshop CS5.1 Macintosh","Strip Byte Counts":"7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 7800 600 bytes","Strip Offsets":"[23 longs]","Unknown tag (0x0129)":"0 1","Unknown tag (0x02bc)":"[14622 shorts]","Unknown tag (0x8649)":"[8822 shorts]","White Point":"1343036288/4294967295 1413044224/4294967295","X Resolution":"1120 dots per inch","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.image.TiffParser"],"Y Resolution":"1120 dots per inch","date":"2014-12-03T12:40:50","dcterms:created":"2014-12-03T12:40:50","dcterms:modified":"2014-12-03T12:40:50","meta:creation-date":"2014-12-03T12:40:50","meta:save-date":"2014-12-03T12:40:50","modified":"2014-12-03T12:40:50","resourceName":"example.tif20170713-88893-1cirjkm","tiff:BitsPerSample":"8","tiff:ImageLength":"287","tiff:ImageWidth":"200","tiff:Make":"Phase One","tiff:Model":"P65+","tiff:Orientation":"1","tiff:ResolutionUnit":"Inch","tiff:SamplesPerPixel":"3","tiff:Software":"Adobe Photoshop CS5.1 Macintosh","tiff:XResolution":"1120.0","tiff:YResolution":"1120.0"}' }
  let(:tika_jpeg_output) { "{\"Content-Length\":\"1874822\",\"Content-Type\":\"image/jpeg\",\"X-Parsed-By\":[\"org.apache.tika.parser.DefaultParser\",\"org.apache.tika.parser.ocr.TesseractOCRParser\"],\"resourceName\":\"large-jpg-test.jpg\"}{\"Aperture Value\":\"F16\",\"Application Record Version\":\"4\",\"Artist\":\"David Kelly Crow\",\"Author\":\"David Kelly Crow\",\"Background Color\":\"0 0 -1 -1 -1 -1 -1 -1 0 0\",\"Bits Per Sample\":\"8 8 8 bits/component/pixel\",\"Blue Colorant\":\"(0.14918518, 0.06321716, 0.7445679)\",\"Blue TRC\":\"0.0085908\",\"Body Serial Number\":\"0520301761\",\"By-line\":\"David Kelly Crow\",\"CMM Type\":\"ADBE\",\"Caption Digest\":\"-16 90 -12 -79 -18 108 -39 -22 -2 46 24 -111 36 -97 98 -119\",\"Class\":\"Display Device\",\"Coded Character Set\":\"UTF-8\",\"Color Halftoning Information\":\"[72 bytes]\",\"Color Space\":\"Undefined\",\"Color Transfer Functions\":\"[112 bytes]\",\"Color space\":\"RGB\",\"Component 1\":\"Y component: Quantization table 0, Sampling factors 2 horiz/2 vert\",\"Component 2\":\"Cb component: Quantization table 1, Sampling factors 1 horiz/1 vert\",\"Component 3\":\"Cr component: Quantization table 1, Sampling factors 1 horiz/1 vert\",\"Compression\":\"Uncompressed\",\"Compression Type\":\"Baseline\",\"Content-Length\":\"1874822\",\"Content-Type\":\"image/jpeg\",\"Copyright\":\"Copyright 1999 Adobe Systems Incorporated\",\"Creation-Date\":\"2014-02-20T04:32:54\",\"Custom Rendered\":\"Normal process\",\"Data Precision\":\"8 bits\",\"Date Created\":\"Thu Feb 20 00:00:00 EST 2014\",\"Date/Time\":\"2014:03:02 13:58:58\",\"Date/Time Digitized\":\"2014:02:20 04:32:54\",\"Date/Time Original\":\"2014:02:20 04:32:54\",\"Device manufacturer\":\"none\",\"Digital Date Created\":\"20140220\",\"Exif Image Height\":\"5091 pixels\",\"Exif Image Width\":\"3394 pixels\",\"Exif Version\":\"2.30\",\"Exposure Bias Value\":\"0 EV\",\"Exposure Mode\":\"Manual exposure\",\"Exposure Program\":\"Manual control\",\"Exposure Time\":\"1/160 sec\",\"F-Number\":\"F16\",\"File Modified Date\":\"Wed Apr 04 16:39:33 EDT 2018\",\"File Name\":\"large-jpg-test.jpg\",\"File Size\":\"1874822 bytes\",\"Firmware\":\"1.0.5\",\"Flash\":\"Flash did not fire, auto\",\"Focal Length\":\"45.0 mm\",\"Focal Plane Resolution Unit\":\"Inches\",\"Focal Plane X Resolution\":\"181/1036800 inches\",\"Focal Plane Y Resolution\":\"119/691200 inches\",\"Global Altitude\":\"30\",\"Global Angle\":\"30\",\"Green Colorant\":\"(0.20527649, 0.6256714, 0.06086731)\",\"Green TRC\":\"0.0085908\",\"Grid and Guides Information\":\"0 0 0 1 0 0 2 64 0 0 2 64 0 0 0 0\",\"ISO Speed Ratings\":\"100\",\"Image Height\":\"5091 pixels\",\"Image Width\":\"3394 pixels\",\"JPEG Quality\":\"12 (Maximum), Standard format, 3 scans\",\"Last-Modified\":\"2014-03-02T13:58:58\",\"Last-Save-Date\":\"2014-03-02T13:58:58\",\"Lens\":\"17-50mm\",\"Lens Information\":\"17/1 50/1 0/0 0/0\",\"Lens Model\":\"17-50mm\",\"Lens Serial Number\":\"0000000000\",\"Lens Specification\":\"17/1 50/1 0/0 0/0\",\"Make\":\"Canon\",\"Max Aperture Value\":\"F2.8\",\"Media Black Point\":\"(0.0, 0.0, 0.0)\",\"Media White Point\":\"(0.9504547, 1.0, 1.0890503)\",\"Metering Mode\":\"Center weighted average\",\"Model\":\"Canon EOS 60D\",\"Number of Components\":\"3\",\"Orientation\":\"Top, left side (Horizontal / normal)\",\"Photometric Interpretation\":\"RGB\",\"Pixel Aspect Ratio\":\"1.0\",\"Planar Configuration\":\"Chunky (contiguous for each subsampling pixel)\",\"Primary Platform\":\"Apple Computer, Inc.\",\"Print Flags\":\"0 0 0 0 0 0 0 0 1\",\"Print Flags Information\":\"0 1 0 0 0 0 0 0 0 1\",\"Print Info 2\":\"[229 bytes]\",\"Print Scale\":\"Centered, Scale 1.0\",\"Print Style\":\"[557 bytes]\",\"Profile Connection Space\":\"XYZ\",\"Profile Date/Time\":\"Fri Jul 02 20:00:00 EDT 1999\",\"Profile Description\":\"Adobe RGB (1998)\",\"Profile Size\":\"560\",\"Recommended Exposure Index\":\"100\",\"Red Colorant\":\"(0.6097412, 0.31111145, 0.019470215)\",\"Red TRC\":\"0.0085908\",\"Resolution Info\":\"300.0x300.0 DPI\",\"Resolution Unit\":\"Inch\",\"Resolution Units\":\"inch\",\"Samples Per Pixel\":\"3 samples/pixel\",\"Scene Capture Type\":\"Standard\",\"Seed Number\":\"3\",\"Sensitivity Type\":\"Recommended Exposure Index\",\"Serial Number\":\"0520301761\",\"Shutter Speed Value\":\"1/159 sec\",\"Signature\":\"acsp\",\"Slices\":\"IMG_2623 (0,0,5091,3394) 1 Slices\",\"Software\":\"Adobe Photoshop CC (Macintosh)\",\"Sub-Sec Time Digitized\":\"24\",\"Sub-Sec Time Original\":\"24\",\"Tag Count\":\"10\",\"Thumbnail Compression\":\"JPEG (old-style)\",\"Thumbnail Data\":\"JpegRGB, 107x160, Decomp 51840 bytes, 1572865 bpp, 5890 bytes\",\"Thumbnail Length\":\"3793 bytes\",\"Thumbnail Offset\":\"992 bytes\",\"Time Created\":\"04:32:54+0000\",\"URL List\":\"0\",\"Version Info\":\"1 (Adobe Photoshop, Adobe Photoshop CC) 1\",\"White Balance Mode\":\"Manual white balance\",\"X Resolution\":\"96 dots per inch\",\"X-Parsed-By\":[\"org.apache.tika.parser.DefaultParser\",\"org.apache.tika.parser.ocr.TesseractOCRParser\",\"org.apache.tika.parser.jpeg.JpegParser\"],\"XMP Value Count\":\"174\",\"XYZ values\":\"0.9642029 1.0 0.8249054\",\"Y Resolution\":\"96 dots per inch\",\"creator\":\"David Kelly Crow\",\"date\":\"2014-03-02T13:58:58\",\"dc:creator\":\"David Kelly Crow\",\"dcterms:created\":\"2014-02-20T04:32:54\",\"dcterms:modified\":\"2014-03-02T13:58:58\",\"exif:DateTimeOriginal\":\"2014-02-20T04:32:54\",\"exif:ExposureTime\":\"0.00625\",\"exif:FNumber\":\"16.0\",\"exif:Flash\":\"false\",\"exif:FocalLength\":\"45.0\",\"exif:IsoSpeedRatings\":\"100\",\"meta:author\":\"David Kelly Crow\",\"meta:creation-date\":\"2014-02-20T04:32:54\",\"meta:save-date\":\"2014-03-02T13:58:58\",\"modified\":\"2014-03-02T13:58:58\",\"resourceName\":\"large-jpg-test.jpg\",\"tiff:BitsPerSample\":\"8\",\"tiff:ImageLength\":\"5091\",\"tiff:ImageWidth\":\"3394\",\"tiff:Make\":\"Canon\",\"tiff:Model\":\"Canon EOS 60D\",\"tiff:Orientation\":\"1\",\"tiff:ResolutionUnit\":\"Inch\",\"tiff:SamplesPerPixel\":\"3\",\"tiff:Software\":\"Adobe Photoshop CC (Macintosh)\",\"tiff:XResolution\":\"300.0\",\"tiff:YResolution\":\"300.0\"}" }
  let(:tika_xml_output) { '{"Content-Length":"38294","Content-Type":"application/xml","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.xml.DcXMLParser"],"resourceName":"example.xml"}' }
  let(:tika_xml_pbcore_output) { '{"Content-Length":"38294","Content-Type":"application/xml; schema=pbcore","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.xml.DcXMLParser"],"resourceName":"example.xml"}' }
  let(:tika_shapefile_output) { '{"Content-Length":"8109","Content-Type":"application/zip","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.pkg.PackageParser"],"resourceName":"shapefile.zip"}' }
  let(:tika_geojson_output) { '{"Content-Encoding":"ISO-8859-1","Content-Length":"487","Content-Type":"text/plain; charset\u003dISO-8859-1","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.txt.TXTParser"],"resourceName":"geo.json"}' }
  let(:tika_geotiff_output) { '{"Content-Length":"285254","Content-Type":"image/tiff","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.ocr.TesseractOCRParser"],"resourceName":"geotiff.tif"},{"Bits Per Sample":"8 bits/component/pixel","Compression":"Uncompressed","Content-Length":"285254","Content-Type":"image/tiff","File Modified Date":"Tue Mar 06 16:15:06 CST 2018","File Name":"geotiff.tif","File Size":"285254 bytes","Image Height":"388 pixels","Image Width":"733 pixels","Photometric Interpretation":"BlackIsZero","Planar Configuration":"Chunky (contiguous for each subsampling pixel)","Resolution Unit":"Inch","Rows Per Strip":"11 rows/strip","Samples Per Pixel":"1 samples/pixel","Strip Byte Counts":"8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 8063 2199 bytes","Strip Offsets":"[36 longs]","Unknown tag (0x0153)":"1","Unknown tag (0x830e)":"229.2942968798232 -8.655255589061459E-58 229.3969364571049","Unknown tag (0x8482)":"0.0 0.0 0.0 0.0 0.0 -7.846135678998241E282","Unknown tag (0x87af)":"[72 ints]","Unknown tag (0x87b0)":"0.0 0.0 -115.0 2.2038608806225308E35 0.9992 5.299800533E-315 500000.0","Unknown tag (0x87b1)":"NAD_1983_10TM_AEP_Forest|NAD83|","X Resolution":"600 dots per inch","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.ocr.TesseractOCRParser","org.apache.tika.parser.image.TiffParser"],"Y Resolution":"600 dots per inch","resourceName":"geotiff.tif","tiff:BitsPerSample":"8","tiff:ImageLength":"388","tiff:ImageWidth":"733","tiff:ResolutionUnit":"Inch","tiff:SamplesPerPixel":"1","tiff:XResolution":"600.0","tiff:YResolution":"600.0"}' }
  let(:tika_arcgrid_output) { '{"Content-Length":"74414","Content-Type":"application/zip","X-Parsed-By":["org.apache.tika.parser.DefaultParser","org.apache.tika.parser.pkg.PackageParser"],"resourceName":"arcgrid.zip"}' }
  let(:tika_output) { tika_tiff_output }
end

RSpec.configure do |config|
  config.include_context "Tika output"
  config.before(:each) do
    ruby_mock = instance_double(RubyTikaApp, to_json: tika_output)
    allow(RubyTikaApp).to receive(:new).and_return(ruby_mock)
    allow_any_instance_of(MiniMagick::Image).to receive(:width).and_return(200)
    allow_any_instance_of(MiniMagick::Image).to receive(:height).and_return(287)
    allow_any_instance_of(MiniMagick::Image).to receive(:mime_type).and_return("image/tiff")
    allow_any_instance_of(MiniMagick::Image).to receive(:size).and_return("196882B")
  end
end
